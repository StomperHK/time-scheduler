import{l as b}from"./style-DMd9yYrQ.js";import{v as U,c as u}from"./createToaster-C2rzx3Hn.js";class c{constructor(e,s){this.hour=e,this.minute=s}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}`}increaseTime(e){const s=(this.minute+e)%60;return s<=this.minute?(this.hour=this.hour+1,this.minute=s):this.minute=s,this.toString()}isSmallerThanOrEqual(e){return this.hour<e.hour||this.hour===e.hour&&this.minute<=e.minute}}const q=document.querySelector("[data-js='user-preferences-button']"),L=document.querySelector("[data-js='user-preferences-modal'] [data-js='save-button']"),N=document.querySelector("[data-js='delete-schedules']"),C=document.querySelector("[data-js='copy-table']"),A=Array.from(document.querySelectorAll("[data-js='close-button']")),x=["Domingo","Segunda-feira","Terça-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sábado"],p=B(D,1500);document.querySelector('[data-js="logo"]').src=b;function B(t,e){let s;return function(){clearInterval(s),s=setTimeout(t,e)}}function D(){const t=document.querySelectorAll('[data-js="schedule"] [data-js="name-input"]');let e={data:{},localUserPreferences:{}};for(const s of t)e.data[s.previousElementSibling.textContent]=s.value;m(d(e.data)),e.localUserPreferences=JSON.parse(localStorage.getItem("schedules")).localUserPreferences,localStorage.setItem("schedules",JSON.stringify(e)),u("Dados salvos")}function J(){localStorage.getItem("schedules")||localStorage.setItem("schedules",'{"data": {}, "localUserPreferences": {}}'),localStorage.getItem("userPreferences")||localStorage.setItem("userPreferences",'{"openingTime": "08:00", "closingTime": "18:30", "sessionDuration": 30}')}function k(t,e){if(!e){const s=JSON.parse(localStorage.getItem("userPreferences"));t.localUserPreferences=s,localStorage.setItem("schedules",JSON.stringify(t))}}function d(t){let e=0;for(const s in t)t[s]!==""&&e++;return e}function m(t){const e=document.querySelector('[data-js="amount-of-schedules"]');e.textContent=t+" cliente(s) para hoje"}function F(){const t=JSON.parse(localStorage.getItem("userPreferences"));Array.from(document.querySelectorAll("[data-js='user-preferences-modal'] select")).forEach(s=>{s.value=t[s.name]})}function g(t,e=!1){const s=document.createDocumentFragment(),r=document.getElementById("schedule"),a=document.getElementById("schedules"),{openingTime:v,closingTime:I,sessionDuration:T}=t.localUserPreferences,n=new c(...v.split(":").map(o=>Number(o))),w=new c(...I.split(":").map(o=>Number(o))),O={time:new c(12,0),wasCreated:!1},j={time:new c(16,0),wasCreated:!1};for(;n.isSmallerThanOrEqual(w);){const o=r.content.cloneNode(!0),f=o.querySelector('[data-js="time"]'),S=o.querySelector('[data-js="name-input"]'),E=o.querySelector('[data-js="delete-button"]');f.textContent=n.toString(),f.setAttribute("datetime",n.toString()),S.addEventListener("input",p),E.addEventListener("click",M),n.toString()in t.data&&(S.value=t.data[n.toString()]),n.increaseTime(T),s.appendChild(o),h(n,O,s),h(n,j,s)}e&&(a.innerHTML=""),a.appendChild(s)}function h(t,e,s){if(e.time.isSmallerThanOrEqual(t)&&!e.wasCreated){e.wasCreated=!0;const r=document.createElement("li"),a=document.createElement("time");a.textContent=e.time.toString(),a.setAttribute("datetime",e.time.toString()),r.className="!my-6 text-center font-bold",a.className="text-gray-500 text-xl",r.appendChild(a),s.appendChild(r)}}function M(t){const s=t.target.closest('[data-js="schedule"]').querySelector('[data-js="name-input"]');s.value="",p()}function y(){document.querySelector("[data-js='user-preferences-modal']").show(),localStorage.setItem("openedUserPreferences",!0)}function $(){const t={};Array.from(document.querySelectorAll("[data-js='user-preferences-modal'] select")).forEach(e=>{t[e.name]=e.name==="sessionDuration"?Number(e.value):e.value}),P(t),localStorage.setItem("userPreferences",JSON.stringify(t)),u("Preferências salvas")}function P(t){const e=JSON.parse(localStorage.getItem("schedules"));d(e.data)||(e.localUserPreferences=t||JSON.parse(localStorage.getItem("userPreferences")),localStorage.setItem("schedules",JSON.stringify(e)),g(e,!0))}function W(){const t=document.querySelectorAll('[data-js="schedule"] [data-js="name-input"]');for(const e of t)e.value="";localStorage.setItem("schedules",'{"data": {}, "localUserPreferences": {}}'),P(),m(0)}function Q(){let t="        "+x[new Date().getDay()]+`
`;const e=JSON.parse(localStorage.getItem("schedules"));for(let s in e)t+=`${s} - ${e[s]}
`;navigator.clipboard.writeText(t).then(()=>{u("Tabela copiada com sucesso")}).catch(()=>{u("Erro ao copiar a tabela","error")})}function V(t){t.target.closest(".modal").close()}let l;const i=document.querySelector('[data-js="install-pwa-button"]');window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),l=t,i.classList.remove("hidden"),i.addEventListener("click",()=>{l.prompt(),l.userChoice.then(e=>{e.outcome==="accepted"?i.classList.add("hidden"):console.log("User dismissed the install prompt"),l=null})})});async function G(){await U()||(window.location.href="/criar-conta/"),J();const e=JSON.parse(localStorage.getItem("schedules")),s=localStorage.getItem("openedUserPreferences"),r=d(e.data);s||y(),m(r),k(e,r),F(),g(e,r)}G();q.addEventListener("click",y);L.addEventListener("click",$);N.addEventListener("click",W);C.addEventListener("click",Q);A.forEach(t=>t.addEventListener("click",V));
