import{l as c}from"./style-DMd9yYrQ.js";import{v as d,c as n}from"./createToaster-C2rzx3Hn.js";const l=document.querySelector('[data-js="login-form"]'),o=document.querySelector('[type="submit"');document.querySelector('[data-js="logo"]').src=c;d().then(e=>{e?window.location.href="/app/":l.addEventListener("submit",m)});async function m(e){e.preventDefault();const t=new FormData(e.target),r=JSON.stringify({email:t.get("email"),password:t.get("password")});u();const i=await fetch("http://localhost:3000/auth/login",{body:r,method:"POST",headers:{"Content-Type":"application/json"}});if(p(),i.ok){const{token:s}=await i.json();n("Login efetuado com sucesso"),localStorage.setItem("token",s),setTimeout(()=>{window.location.href="/app/"},2e3)}else{const{message:s}=await i.json();let a="";s==="missing fields"&&(a="Digite e-mail e senha"),s==="wrong login"&&(a="Dados de login incorretos"),s==="server error"&&(a="Erro ao acessar banco de dados"),n(a,"error")}}function u(){const[e,t]=o.children;o.disabled=!0,o.classList.add("opacity-70"),e.classList.remove("hidden"),t.classList.add("opacity-0")}function p(){const[e,t]=o.children;o.disabled=!1,o.classList.add("opacity-100"),e.classList.add("hidden"),t.classList.remove("opacity-0")}
